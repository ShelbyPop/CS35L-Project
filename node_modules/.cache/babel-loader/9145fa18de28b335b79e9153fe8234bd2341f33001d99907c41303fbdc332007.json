{"ast":null,"code":"'use client';\n\nimport { useCallback, useState, useEffect } from 'react';\nimport { useWindowEvent } from '../use-window-event/use-window-event.mjs';\nfunction serializeJSON(value, hookName = \"use-local-storage\") {\n  try {\n    return JSON.stringify(value);\n  } catch (error) {\n    throw new Error(`@mantine/hooks ${hookName}: Failed to serialize the value`);\n  }\n}\nfunction deserializeJSON(value) {\n  try {\n    return value && JSON.parse(value);\n  } catch {\n    return value;\n  }\n}\nfunction createStorageHandler(type) {\n  const getItem = key => {\n    try {\n      return window[type].getItem(key);\n    } catch (error) {\n      console.warn(\"use-local-storage: Failed to get value from storage, localStorage is blocked\");\n      return null;\n    }\n  };\n  const setItem = (key, value) => {\n    try {\n      window[type].setItem(key, value);\n    } catch (error) {\n      console.warn(\"use-local-storage: Failed to set value to storage, localStorage is blocked\");\n    }\n  };\n  const removeItem = key => {\n    try {\n      window[type].removeItem(key);\n    } catch (error) {\n      console.warn(\"use-local-storage: Failed to remove value from storage, localStorage is blocked\");\n    }\n  };\n  return {\n    getItem,\n    setItem,\n    removeItem\n  };\n}\nfunction createStorage(type, hookName) {\n  const eventName = type === \"localStorage\" ? \"mantine-local-storage\" : \"mantine-session-storage\";\n  const {\n    getItem,\n    setItem,\n    removeItem\n  } = createStorageHandler(type);\n  return function useStorage({\n    key,\n    defaultValue,\n    getInitialValueInEffect = true,\n    deserialize = deserializeJSON,\n    serialize = value => serializeJSON(value, hookName)\n  }) {\n    const readStorageValue = useCallback(skipStorage => {\n      let storageBlockedOrSkipped;\n      try {\n        storageBlockedOrSkipped = typeof window === \"undefined\" || !(type in window) || window[type] === null || !!skipStorage;\n      } catch (_e) {\n        storageBlockedOrSkipped = true;\n      }\n      if (storageBlockedOrSkipped) {\n        return defaultValue;\n      }\n      const storageValue = getItem(key);\n      return storageValue !== null ? deserialize(storageValue) : defaultValue;\n    }, [key, defaultValue]);\n    const [value, setValue] = useState(readStorageValue(getInitialValueInEffect));\n    const setStorageValue = useCallback(val => {\n      if (val instanceof Function) {\n        setValue(current => {\n          const result = val(current);\n          setItem(key, serialize(result));\n          window.dispatchEvent(new CustomEvent(eventName, {\n            detail: {\n              key,\n              value: val(current)\n            }\n          }));\n          return result;\n        });\n      } else {\n        setItem(key, serialize(val));\n        window.dispatchEvent(new CustomEvent(eventName, {\n          detail: {\n            key,\n            value: val\n          }\n        }));\n        setValue(val);\n      }\n    }, [key]);\n    const removeStorageValue = useCallback(() => {\n      removeItem(key);\n      window.dispatchEvent(new CustomEvent(eventName, {\n        detail: {\n          key,\n          value: defaultValue\n        }\n      }));\n    }, []);\n    useWindowEvent(\"storage\", event => {\n      if (event.storageArea === window[type] && event.key === key) {\n        setValue(deserialize(event.newValue ?? void 0));\n      }\n    });\n    useWindowEvent(eventName, event => {\n      if (event.detail.key === key) {\n        setValue(event.detail.value);\n      }\n    });\n    useEffect(() => {\n      if (defaultValue !== void 0 && value === void 0) {\n        setStorageValue(defaultValue);\n      }\n    }, [defaultValue, value, setStorageValue]);\n    useEffect(() => {\n      if (getInitialValueInEffect) {\n        setStorageValue(readStorageValue());\n      }\n    }, []);\n    return [value === void 0 ? defaultValue : value, setStorageValue, removeStorageValue];\n  };\n}\nfunction readValue(type) {\n  const {\n    getItem\n  } = createStorageHandler(type);\n  return function read({\n    key,\n    defaultValue,\n    deserialize = deserializeJSON\n  }) {\n    let storageBlockedOrSkipped;\n    try {\n      storageBlockedOrSkipped = typeof window === \"undefined\" || !(type in window) || window[type] === null;\n    } catch (_e) {\n      storageBlockedOrSkipped = true;\n    }\n    if (storageBlockedOrSkipped) {\n      return defaultValue;\n    }\n    const storageValue = getItem(key);\n    return storageValue !== null ? deserialize(storageValue) : defaultValue;\n  };\n}\nexport { createStorage, readValue };","map":{"version":3,"names":["serializeJSON","value","hookName","JSON","stringify","error","Error","deserializeJSON","parse","createStorageHandler","type","getItem","key","window","console","warn","setItem","removeItem","createStorage","eventName","useStorage","defaultValue","getInitialValueInEffect","deserialize","serialize","readStorageValue","useCallback","skipStorage","storageBlockedOrSkipped","_e","storageValue","setValue","useState","setStorageValue","val","Function","current","result","dispatchEvent","CustomEvent","detail","removeStorageValue","useWindowEvent","event","storageArea","newValue","useEffect","readValue","read"],"sources":["/Users/virounikamina/pompom/node_modules/@mantine/hooks/src/use-local-storage/create-storage.ts"],"sourcesContent":["/* eslint-disable no-console */\nimport { useCallback, useEffect, useState } from 'react';\nimport { useWindowEvent } from '../use-window-event/use-window-event';\n\nexport type StorageType = 'localStorage' | 'sessionStorage';\n\nexport interface StorageProperties<T> {\n  /** Storage key */\n  key: string;\n\n  /** Default value that will be set if value is not found in storage */\n  defaultValue?: T;\n\n  /** If set to true, value will be update is useEffect after mount */\n  getInitialValueInEffect?: boolean;\n\n  /** Function to serialize value into string to be save in storage */\n  serialize?: (value: T) => string;\n\n  /** Function to deserialize string value from storage to value */\n  deserialize?: (value: string | undefined) => T;\n}\n\nfunction serializeJSON<T>(value: T, hookName: string = 'use-local-storage') {\n  try {\n    return JSON.stringify(value);\n  } catch (error) {\n    throw new Error(`@mantine/hooks ${hookName}: Failed to serialize the value`);\n  }\n}\n\nfunction deserializeJSON(value: string | undefined) {\n  try {\n    return value && JSON.parse(value);\n  } catch {\n    return value;\n  }\n}\n\nfunction createStorageHandler(type: StorageType) {\n  const getItem = (key: string) => {\n    try {\n      return window[type].getItem(key);\n    } catch (error) {\n      console.warn('use-local-storage: Failed to get value from storage, localStorage is blocked');\n      return null;\n    }\n  };\n\n  const setItem = (key: string, value: string) => {\n    try {\n      window[type].setItem(key, value);\n    } catch (error) {\n      console.warn('use-local-storage: Failed to set value to storage, localStorage is blocked');\n    }\n  };\n\n  const removeItem = (key: string) => {\n    try {\n      window[type].removeItem(key);\n    } catch (error) {\n      console.warn(\n        'use-local-storage: Failed to remove value from storage, localStorage is blocked'\n      );\n    }\n  };\n\n  return { getItem, setItem, removeItem };\n}\n\nexport function createStorage<T>(type: StorageType, hookName: string) {\n  const eventName = type === 'localStorage' ? 'mantine-local-storage' : 'mantine-session-storage';\n  const { getItem, setItem, removeItem } = createStorageHandler(type);\n\n  return function useStorage({\n    key,\n    defaultValue,\n    getInitialValueInEffect = true,\n    deserialize = deserializeJSON,\n    serialize = (value: T) => serializeJSON(value, hookName),\n  }: StorageProperties<T>) {\n    const readStorageValue = useCallback(\n      (skipStorage?: boolean): T => {\n        let storageBlockedOrSkipped;\n\n        try {\n          storageBlockedOrSkipped =\n            typeof window === 'undefined' ||\n            !(type in window) ||\n            window[type] === null ||\n            !!skipStorage;\n        } catch (_e) {\n          storageBlockedOrSkipped = true;\n        }\n\n        if (storageBlockedOrSkipped) {\n          return defaultValue as T;\n        }\n\n        const storageValue = getItem(key);\n        return storageValue !== null ? deserialize(storageValue) : (defaultValue as T);\n      },\n      [key, defaultValue]\n    );\n\n    const [value, setValue] = useState<T>(readStorageValue(getInitialValueInEffect));\n\n    const setStorageValue = useCallback(\n      (val: T | ((prevState: T) => T)) => {\n        if (val instanceof Function) {\n          setValue((current) => {\n            const result = val(current);\n            setItem(key, serialize(result));\n            window.dispatchEvent(\n              new CustomEvent(eventName, { detail: { key, value: val(current) } })\n            );\n            return result;\n          });\n        } else {\n          setItem(key, serialize(val));\n          window.dispatchEvent(new CustomEvent(eventName, { detail: { key, value: val } }));\n          setValue(val);\n        }\n      },\n      [key]\n    );\n\n    const removeStorageValue = useCallback(() => {\n      removeItem(key);\n      window.dispatchEvent(new CustomEvent(eventName, { detail: { key, value: defaultValue } }));\n    }, []);\n\n    useWindowEvent('storage', (event) => {\n      if (event.storageArea === window[type] && event.key === key) {\n        setValue(deserialize(event.newValue ?? undefined));\n      }\n    });\n\n    useWindowEvent(eventName, (event) => {\n      if (event.detail.key === key) {\n        setValue(event.detail.value);\n      }\n    });\n\n    useEffect(() => {\n      if (defaultValue !== undefined && value === undefined) {\n        setStorageValue(defaultValue);\n      }\n    }, [defaultValue, value, setStorageValue]);\n\n    useEffect(() => {\n      if (getInitialValueInEffect) {\n        setStorageValue(readStorageValue());\n      }\n    }, []);\n\n    return [value === undefined ? defaultValue : value, setStorageValue, removeStorageValue] as [\n      T,\n      (val: T | ((prevState: T) => T)) => void,\n      () => void,\n    ];\n  };\n}\n\nexport function readValue(type: StorageType) {\n  const { getItem } = createStorageHandler(type);\n\n  return function read<T>({\n    key,\n    defaultValue,\n    deserialize = deserializeJSON,\n  }: StorageProperties<T>) {\n    let storageBlockedOrSkipped;\n\n    try {\n      storageBlockedOrSkipped =\n        typeof window === 'undefined' || !(type in window) || window[type] === null;\n    } catch (_e) {\n      storageBlockedOrSkipped = true;\n    }\n\n    if (storageBlockedOrSkipped) {\n      return defaultValue as T;\n    }\n\n    const storageValue = getItem(key);\n    return storageValue !== null ? deserialize(storageValue) : (defaultValue as T);\n  };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}